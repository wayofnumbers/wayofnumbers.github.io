<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Michael Li" />

        <meta name="twitter:creator" content="@lymenlee">
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Machine Learning, AI, NLP, fast.ai, Deep Learning, Machine Learning, " />

<meta property="og:title" content="Attack Toxic Comments Kaggle Competition usingÂ Fast.ai "/>
<meta property="og:url" content="https://wayofnumbers.com/attack-toxic-comments-kaggle-competition-using-fast-ai.html" />
<meta property="og:description" content="Described how to build a multi-label toxic comments classifier from scratch usingÂ fast.ai" />
<meta property="og:site_name" content="Way of Numbers" />
<meta property="og:article:author" content="Michael Li" />
<meta property="og:article:published_time" content="2019-10-08T20:00:00-05:00" />
<meta name="twitter:title" content="Attack Toxic Comments Kaggle Competition usingÂ Fast.ai ">
<meta name="twitter:description" content="Described how to build a multi-label toxic comments classifier from scratch usingÂ fast.ai">

        <title>Attack Toxic Comments Kaggle Competition usingÂ Fast.ai  Â· Way of Numbers
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://wayofnumbers.com/theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://wayofnumbers.com/theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://wayofnumbers.com/theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://wayofnumbers.com/theme/css/admonition.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://wayofnumbers.com/theme/css/custom.css" media="screen">

        <link rel="shortcut icon" href="https://wayofnumbers.com/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="https://wayofnumbers.com/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="https://wayofnumbers.com/theme/images/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://wayofnumbers.com/theme/images/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://wayofnumbers.com/theme/images/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="https://wayofnumbers.com/theme/images/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://wayofnumbers.com/theme/images/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="https://wayofnumbers.com/theme/images/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://wayofnumbers.com/theme/images/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://wayofnumbers.com/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link href="https://wayofnumbers.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Way of Numbers - Full Atom Feed" />
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-148798026-1', 'auto');
    ga('send', 'pageview');
</script>


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://wayofnumbers.com/"><span class=site-name>Way of Numbers</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://wayofnumbers.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://wayofnumbers.com/categories">Categories</a></li>
                                <li ><a href="https://wayofnumbers.com/tags">Tags</a></li>
                                <li ><a href="https://wayofnumbers.com/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://wayofnumbers.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://wayofnumbers.com/attack-toxic-comments-kaggle-competition-using-fast-ai.html"> Attack Toxic Comments Kaggle Competition using&nbsp;Fast.ai  </a></h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc">
<ul>
<li><a href="#the-data-set">The DataÂ Set</a></li>
<li><a href="#look-at-the-data">Look at theÂ Data</a></li>
<li><a href="#transfer-learning-fine-tune-our-language-model">Transfer Learning: Fine-Tune Our LanguageÂ Model</a></li>
<li><a href="#transfer-learning-training-the-classifier">Transfer Learning: Training theÂ Classifier</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">
            
            
<p>How to build a multi-label <span class="caps">NLP</span> classifier fromÂ scratch</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/0*SxwidHTBf5ZSysg9.jpg"/></p>
<p><a href="http://www.kaggle.com">Kaggle</a> is a good place to learn and practice your Machine Learning skills. Itâ€™s also a great place to find the proper dataset for your learning projects. I need a good classification <span class="caps">NLP</span> dataset to practice my recently learned fast.ai lesson, and I came across the <a href="https://www.kaggle.com/c/jigsaw-toxic-comment-classification-challenge">Toxic Comment Classification Challenge</a>. The competition is held two years ago and has long concluded, but it doesnâ€™t hurt to submit my scores and see how well I did. This is one of the things Kaggle is great for since in the real world, it will usually be much harder to know how good or bad your model is, whereas, in Kaggle, youâ€™ll see clearly where your performance is in theÂ Leaderboard.</p>
<h2 id="the-data-set">The Data Set<a class="headerlink" href="#the-data-set" title="Permanent link">Â¶</a></h2>
<p>This competition is held by The <a href="https://conversationai.github.io/">Conversation <span class="caps">AI</span></a> team, a research initiative founded by <a href="https://jigsaw.google.com/">Jigsaw</a> and Google (both a part of Alphabet). Its goal is to find out the best model that can classify multiple toxicity types in comments. The toxicity typesÂ are:</p>
<blockquote>
<p>toxic
severe_toxic
obscene
threat
insultÂ indentity_hate</p>
</blockquote>
<p>Comments are given in a training file train.cvs and a testing file test.csv. And youâ€™ll need to predict a probability of each type of toxicity for each comment in test.csv. It is a multi-label <span class="caps">NLP</span> classificationÂ problem.</p>
<h2 id="look-at-the-data">Look at the Data<a class="headerlink" href="#look-at-the-data" title="Permanent link">Â¶</a></h2>
<p>Letâ€™s first take a look at the data. We need to import the necessary modules and do some logistics to set up the paths for ourÂ files.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span> <span class="o">*</span><span class="c1"># linear algebra*</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span> <span class="o">*</span><span class="c1"># data processing, CSV file I/O (e.g. pd.read_csv)</span>
<span class="o">*</span><span class="kn">from</span> <span class="nn">fastai.text</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<p>Notice here we imported everything from fastai.text and fastai modules. Are we against the software engineering best practice here? Actually, not quite. Itâ€™s rather a deliberate move in a more iterative and interactive data science kind of way. With all the library available, I can easily test and try different functions/modules without having to go back and import them every time. It will make the explore/experiment flow much more smoothly. But I digressed, letâ€™s load the data and look atÂ it:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">Kaggle</span> <span class="n">store</span> <span class="n">dataset</span> <span class="k">in</span> <span class="n">the</span> <span class="o">/</span><span class="n">kaggle</span><span class="o">/</span><span class="k">input</span><span class="o">/</span> <span class="n">folder</span><span class="p">,</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">'/kaggle/input/jigsaw-toxic-comment-classification-challenge/'</span><span class="p">)</span>
<span class="n">path</span><span class="p">.</span><span class="n">ls</span><span class="p">()</span>

<span class="o">#</span> <span class="n">the</span> <span class="o">/</span><span class="n">kaggle</span><span class="o">/</span><span class="k">input</span><span class="o">/</span> <span class="n">folder</span> <span class="k">is</span> <span class="k">read</span><span class="o">-</span><span class="k">only</span><span class="p">,</span> <span class="k">copy</span> <span class="n">away</span> <span class="n">so</span> <span class="n">I</span> <span class="n">can</span> <span class="n">also</span> <span class="k">write</span> <span class="k">to</span> <span class="n">the</span> <span class="n">folder</span><span class="p">.</span> 
<span class="o">!</span><span class="n">mkdir</span> <span class="k">data</span>
<span class="o">!</span><span class="n">cp</span> <span class="o">-</span><span class="n">a</span> <span class="err">{</span><span class="n">path</span><span class="err">}</span><span class="cm">/*.* ./data/</span>
<span class="cm">!ls data</span>

<span class="cm"># make sure everything is correctly copied over</span>
<span class="cm">path = Path('/kaggle/working/data/')</span>
<span class="cm">path.ls()</span>

<span class="cm"># read in the data and have a peak</span>
<span class="cm">df = pd.read_csv(path/'train.csv')</span>
<span class="cm">df.head()</span>
</pre></div>
<p><img alt="The toxicity types are one-hot encoded" src="https://cdn-images-1.medium.com/max/2000/1*XhZcKKIvj9-r0RmksgoYXQ.png"/><em>The toxicity types are one-hotÂ encoded</em></p>
<p>The comments are in comment_text column and all toxicity types are â€˜one-hotâ€™ encoded, weâ€™ll have to do something about it to make it fit into our modelÂ later.</p>
<p><img alt="Have a look at one comment" src="https://cdn-images-1.medium.com/max/2000/1*9hNkR1Z0Y279_xNxfZ-bMw.png"/><em>Have a look at oneÂ comment</em></p>
<h2 id="transfer-learning-fine-tune-our-language-model">Transfer Learning: Fine-Tune Our Language Model<a class="headerlink" href="#transfer-learning-fine-tune-our-language-model" title="Permanent link">Â¶</a></h2>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/0*ZItmfFjXqRgyJIbw.jpg"/></p>
<p>Weâ€™ll use transfer learning for this task, to do that, weâ€™ll use a pre-trained model based on Wikipedia called <a href="https://einstein.ai/research/blog/the-wikitext-long-term-dependency-language-modeling-dataset">wikitext-103</a>. It is a model thatâ€™s already trained from the Wikipedia dataset(or â€˜corpusâ€™ in <span class="caps">NLP</span> terms) to predict the next words from a giving unfinished sentence. Weâ€™ll leverage the â€˜language knowledgeâ€™ the model already learned from the Wikipedia dataset and build on top of that. To achieve the best results, weâ€™ll need to â€˜fine-tuneâ€™ the model to make it learn a bit from our â€˜commentsâ€™ dataset since what people say in the comments are not necessarily the same with the more formal Wiki. Once the language model is fine-tuned, we can then use it to further do our classificationÂ task.</p>
<p>Now letâ€™s load the training data into the fast.ai databunch so we can start training the language modelÂ first.</p>
<div class="highlight"><pre><span></span><span class="nv">bs</span> <span class="o">=</span> <span class="mi">64</span>   # <span class="nv">set</span> <span class="nv">batch</span> <span class="nv">size</span> <span class="nv">to</span> <span class="mi">64</span>, <span class="nv">works</span> <span class="k">for</span> <span class="nv">Kaggle</span> <span class="nv">Kernels</span>
<span class="nv">data_lm</span> <span class="o">=</span> <span class="ss">(</span><span class="nv">TextList</span>.<span class="nv">from_df</span><span class="ss">(</span><span class="nv">df</span>, <span class="nv">path</span>, <span class="nv">cols</span><span class="o">=</span><span class="s1">'</span><span class="s">comment_text</span><span class="s1">'</span><span class="ss">)</span>
                .<span class="nv">split_by_rand_pct</span><span class="ss">(</span><span class="mi">0</span>.<span class="mi">1</span><span class="ss">)</span>
                .<span class="nv">label_for_lm</span><span class="ss">()</span>
                .<span class="nv">databunch</span><span class="ss">(</span><span class="nv">bs</span><span class="o">=</span><span class="nv">bs</span><span class="ss">))</span>
</pre></div>
<p>We use fast.aiâ€™s Data Block <span class="caps">API</span> for this task. It is a very flexible and powerful way to address the challenging task of building a pipeline: loading your data into the model. It isolates the entire process into different parts/steps, each step with multiple methods/functions to adapt to different types of data and the ways data is stored. This concept is a lot like the Linux philosophy, highly modulized and with each module only do one thing but really really well. You are free to explore the wonderful <span class="caps">API</span> <a href="https://docs.fast.ai/data_block.html">here</a>, for the above code though, it does the followingÂ things:</p>
<ol>
<li>
<p>Import data from Pandas DataFrame named df, tell the model to use comment_text as input (TextList.from_df(df, path,Â cols=â€™comment_textâ€™))</p>
</li>
<li>
<p>Split the training dataset into train/validation set by random 10/90 percent.Â (.split_by_rand_pct(0.1))</p>
</li>
<li>
<p>Ignore the given labels( since we are only fine-tuning the language model, not training the classifier yet) and use the language modelâ€™s â€˜predict next wordâ€™ as labels.Â (.label_for_lm())</p>
</li>
<li>
<p>Build the data into a databunch, with batch size bs.Â (.databunch(bs=bs))</p>
</li>
</ol>
<p>Now letâ€™s look at the databunch we justÂ built:</p>
<p><img alt="Notice we lost all the toxicity types" src="https://cdn-images-1.medium.com/max/2000/1*tZb2mpF3ybJizigXjZD7Vw.png"/><em>Notice we lost all the toxicityÂ types</em></p>
<p>Notice that the databunch doesnâ€™t have all the toxicity type labels since we are only fine-tuning the languageÂ model.</p>
<p><span class="caps">OK</span>, time for some typical fast.ai learning rate adjustments andÂ training:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*vKptpwNJ5yj-ufCweNY5cQ.png"/></p>
<p>We put our databunch into a language_model_learner, tell it the language model base we want to use (AWD_LSTM) and assign a default dropout rate of <strong>0.3</strong>. From the <span class="caps">LR</span> Finder graph, find the biggest downward slope and pick the middle point as our learning rate. (For a more detailed explanation of how this â€˜fit_one_cycleâ€™ magic is done, please refer to this <a href="https://docs.fast.ai/callbacks.one_cycle.html#What-is-1cycle?">article</a>. It is a <span class="caps">SOTA</span> technique of fast.ai that combines learning rate and momentum annealing). Now we can â€˜unfreezeâ€™ the model and train the entire model couple ofÂ epochs:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*pQRrm9fcMkRua9k9LbBbzA.png"/></p>
<p>We can look at one example of how well the modelÂ did:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*UCNNMwGBhh7oxbRIMxg7Pg.png"/></p>
<p>The result is hardly optimal. Ideally, we need to train a bit more epochs but for this Kaggle Kernel, I was running out of <span class="caps">GPU</span> quota so I stopped at 4. The result definitely has room to improve and you can try it yourself. Anyway, what we want from the language model is the encoder part, so we saveÂ it.</p>
<div class="highlight"><pre><span></span><span class="o">*</span># <span class="nv">save</span> <span class="nv">the</span> <span class="nv">encoder</span> <span class="k">for</span> <span class="k">next</span> <span class="nv">step</span> <span class="nv">use</span><span class="o">*</span>
<span class="nv">learn</span>.<span class="nv">save_encoder</span><span class="ss">(</span><span class="s1">'</span><span class="s">fine_tuned_enc</span><span class="s1">'</span><span class="ss">)</span>
</pre></div>
<h2 id="transfer-learning-training-the-classifier">Transfer Learning: Training the Classifier<a class="headerlink" href="#transfer-learning-training-the-classifier" title="Permanent link">Â¶</a></h2>
<p>Letâ€™s read in the testÂ dataset:</p>
<div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="ss">"test.csv"</span><span class="p">)</span>
<span class="n">test_datalist</span> <span class="o">=</span> <span class="n">TextList</span><span class="p">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="s1">'comment_text'</span><span class="p">)</span>
</pre></div>
<p>Again, build ourÂ databunch:</p>
<div class="highlight"><pre><span></span><span class="n">data_cls</span> <span class="o">=</span> <span class="p">(</span><span class="n">TextList</span><span class="p">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">'train.csv'</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="s1">'comment_text'</span><span class="p">)</span>
                <span class="p">.</span><span class="n">split_by_rand_pct</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>
                <span class="p">.</span><span class="n">label_from_df</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">'toxic'</span><span class="p">,</span> <span class="s1">'severe_toxic'</span><span class="p">,</span><span class="s1">'obscene'</span><span class="p">,</span> <span class="s1">'threat'</span><span class="p">,</span> <span class="s1">'insult'</span><span class="p">,</span> <span class="s1">'identity_hate'</span><span class="p">],</span> <span class="n">label_cls</span><span class="o">=</span><span class="n">MultiCategoryList</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
                <span class="p">.</span><span class="n">add_test</span><span class="p">(</span><span class="n">test_datalist</span><span class="p">)</span>
                <span class="p">.</span><span class="n">databunch</span><span class="p">())</span>
<span class="n">data_cls</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'data_clas.pkl'</span><span class="p">)</span>
</pre></div>
<p>Please note the difference thisÂ time:</p>
<ol>
<li>
<p>We now use all our toxicity styles labels (.label_from_df(cols=[â€˜toxicâ€™, â€˜severe_toxicâ€™,â€™obsceneâ€™, â€˜threatâ€™, â€˜insultâ€™, â€˜identity_hateâ€™],label_cls=MultiCategoryList,Â one_hot=True),)</p>
</li>
<li>
<p>We added our test set here.Â (.add_test(test_datalist))</p>
</li>
</ol>
<p>Now look at our classifier databunchÂ :</p>
<p><img alt="Note that now we have all the toxicity styles labels" src="https://cdn-images-1.medium.com/max/2000/1*47Wryn1f-yDMfiu3l-bXMA.png"/><em>Note that now we have all the toxicity stylesÂ labels</em></p>
<p><strong>Finally, time to put everything together!</strong> Weâ€™ll put the databunch into the text_classifier_learner model and load the encoder we learned from the languageÂ model.</p>
<div class="highlight"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">text_classifier_learner</span><span class="p">(</span><span class="n">data_clas</span><span class="p">,</span> <span class="n">AWD_LSTM</span><span class="p">,</span> <span class="n">drop_mult</span><span class="o">=</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">learn</span><span class="p">.</span><span class="n">load_encoder</span><span class="p">(</span><span class="s1">'fine_tuned_enc'</span><span class="p">)</span>
</pre></div>
<p>Again, find the best learning rate and train oneÂ cycle:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*xXpZwueb6Yec9TvVvJN7SA.png"/></p>
<p>Train a bit more cycles andÂ unfreeze:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*GcvvzZNPv9Qe1M1bwvcjEA.png"/></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*2Ny7Ka7Ewv6b_0TH8R8RsA.png"/></p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*BWi5dpbgRmwyvr7VQdh59A.png"/></p>
<p>See theÂ results:</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*vePv-fiRXOukp3ZgteqwnA.png"/></p>
<p>Off by one, but overall the prediction is <span class="caps">OK</span>. For the purpose of reference, I submitted the prediction to Kaggle and get a 0.96583 Public Score. The result is not optimal but like I said I didnâ€™t train all the way due to limited <span class="caps">GPU</span>. The purpose of this article is to show you the whole process of using fast.ai to tackle multi-labels text classification problem. The real challenge here is to load the data into the model using Data Block <span class="caps">API</span>.</p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">Â¶</a></h2>
<p>I hope you learned a thing or two from this article. Fast.ai is really a lean, flexible and powerful library. For the things it can do (like image/text classification, tabular data, collaborative filtering, etc.), it does it very well. It is not as extensive as Keras, but itâ€™s very sharp and focused. Kind of like Vim and Emacs if you are familiar with the command line text editor war.Â ğŸ˜œ</p>
<blockquote>
<p>You can find the Kaggle Kernel <a href="https://www.kaggle.com/lymenlee/toxic-comments-classification-fast-ai">here</a>.</p>
</blockquote>
<p>Any feedback or constructive criticism is welcomed. You can either find me on Twitter <a href="https://twitter.com/lymenlee">@lymenlee</a> or my blog site <a href="https://wayofnumbers.com/">wayofnumbers.com</a>.</p>


            <div>
            <span class="author_blurb"><a href=""><span class="author_name">Michael Li</span></a> -
                </span><br />
</div>

            
            <section>
<p id="comment-message">So what do you think? Did I miss anything? Is any part unclear? Leave your comments below. </p>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="https://wayofnumbers.com/attack-toxic-comments-kaggle-competition-using-fast-ai.html#disqus_thread",
                id="disqus-accordion-toggle">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'way-of-numbers';
        var disqus_identifier = 'https://wayofnumbers.com/attack-toxic-comments-kaggle-competition-using-fast-ai.html';
    var disqus_url = 'https://wayofnumbers.com/attack-toxic-comments-kaggle-competition-using-fast-ai.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

                </div>
            </div>
        </div>
    </div>
</div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">Â« <a href="https://wayofnumbers.com/9-things-i-learned-from-blogging-on-medium-for-the-first-month.html" title="Previous: 9 Things I Learned from Blogging on Medium for the FirstÂ Month">9 Things I Learned from Blogging on Medium for the FirstÂ Month</a></li>
                <li class="next-article"><a href="https://wayofnumbers.com/this-is-cs50-a-pleasant-way-to-kick-off-your-data-science-education.html" title="Next: This is CS50â€: A Pleasant Way to Kick Off Your Data ScienceÂ Education">This is CS50â€: A Pleasant Way to Kick Off Your Data ScienceÂ Education</a> Â»</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2019-10-08T20:00:00-05:00">Oct 8, 2019</time>
            <h4>Category</h4>
            <a class="category-link" href="https://wayofnumbers.com/categories.html#machine-learning-ref">Machine Learning</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://wayofnumbers.com/tags#ai-ref">AI
                    <span>10</span>
</a></li>
                <li><a href="https://wayofnumbers.com/tags#deep-learning-ref">Deep Learning
                    <span>6</span>
</a></li>
                <li><a href="https://wayofnumbers.com/tags#fastai-ref">fast.ai
                    <span>5</span>
</a></li>
                <li><a href="https://wayofnumbers.com/tags#machine-learning-ref">Machine Learning
                    <span>11</span>
</a></li>
                <li><a href="https://wayofnumbers.com/tags#nlp-ref">NLP
                    <span>2</span>
</a></li>
            </ul>
<h4>Contact</h4>
    <a href="https://twitter.com/lymenlee" title="My Twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-twitter sidebar-social-links"></i></a>
    <a href="https://medium.com/@lymenlee" title="My Medium Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-medium sidebar-social-links"></i></a>
    <a href="https://github.com/wayofnumbers" title="My GitHub Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-github sidebar-social-links"></i></a>
    <a href="www.linkedin.com/in/michael-li-dfw" title="My LinkedIn Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
<!-- Begin MailChimp Signup Form -->
<div id="mc-embed-signup">
<form action="https://github.us17.list-manage.com/subscribe/post?u=c212184cc0965bdf1658f69f0&amp;id=5677a7b75e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
<h4>Get Monthly Updates</h4>
<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Enter your email..." required>
<div class="clear"><input type="submit" value="Send me Free Updates" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
</form>
</div>
<!--End mc_embed_signup-->
        </div>
        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>

    <div>
        <span class="site-name">Way of Numbers</span> - Data science for the rest of us.
    </div>


    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

            <script type="text/javascript">
var disqus_shortname = 'way-of-numbers';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script  language="javascript" type="text/javascript">
function uncollapse() {
    if (window.location.hash.match(/^#comment-\d+$/)) {
        $('#disqus_thread').collapse('show');
    }
}
</script>
<script type="text/javascript" language="JavaScript">
uncollapse();
window.onhashchange=function(){
    if (window.location.hash.match(/^#comment-\d+$/))
        window.location.reload(true);
}
</script>
<script>
$('#disqus_thread').on('shown', function () {
    var link = document.getElementById('disqus-accordion-toggle');
    var old_innerHTML = link.innerHTML;
    $(link).fadeOut(500, function() {
        $(this).text('Click here to hide comments').fadeIn(500);
    });
    $('#disqus_thread').on('hidden', function () {
        $(link).fadeOut(500, function() {
            $(this).text(old_innerHTML).fadeIn(500);
        });
    })
})
</script>


    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>